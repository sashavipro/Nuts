{% extends "base.html" %}
{% load i18n %}

{% block content %}
<section style="padding: 100px 0; min-height: 60vh; background: #fcfcfc;">
    <div class="container d-flex justify-content-center">
        <div class="payment-card" style="background: #fff; padding: 40px; border-radius: 10px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); max-width: 450px; width: 100%;">

            <h2 class="text-center mb-2" style="color: #1a2f3a; font-weight: 800;">{% trans "Оплата заказа" %}</h2>
            <p class="text-center mb-4" style="color: #888;">{% trans "Заказ" %} #{{ order.order_number }}</p>

            <div class="d-flex justify-content-between align-items-center mb-4" style="background: #f2f7f4; padding: 15px; border-radius: 5px;">
                <span style="font-size: 16px;">{% trans "К оплате" %}:</span>
                <span style="font-size: 24px; font-weight: 800; color: #3d8063;">{{ order.total_amount }} {% trans "грн." %}</span>
            </div>

            <form method="post">
                {% csrf_token %}
                <div style="margin-bottom: 15px;">
                    <label style="font-size: 13px; color: #888;">{% trans "Номер карты" %}</label>
                    <input type="text" id="card-number" inputmode="numeric" placeholder="0000 0000 0000 0000" maxlength="19" required style="width: 100%; padding: 12px; border: 1px solid #ddd; font-size: 16px; letter-spacing: 2px;">
                </div>

                <div class="row mb-4">
                    <div class="col-6">
                        <label style="font-size: 13px; color: #888;">{% trans "Срок действия" %}</label>
                        <input type="text" id="card-expiry" inputmode="numeric" placeholder="MM/YY" maxlength="5" required style="width: 100%; padding: 12px; border: 1px solid #ddd; font-size: 16px; text-align: center;">
                    </div>
                    <div class="col-6">
                        <label style="font-size: 13px; color: #888;">CVV</label>
                        <input type="password" id="card-cvv" inputmode="numeric" placeholder="•••" maxlength="3" required style="width: 100%; padding: 12px; border: 1px solid #ddd; font-size: 16px; text-align: center;">
                    </div>
                </div>

                <button type="submit" class="button button-green w-100" style="padding: 15px; font-size: 18px; border: none; cursor: pointer;">
                    {% trans "Оплатить" %}
                </button>
            </form>

            <div class="text-center mt-3">
                <i class="nut-icon icons-lock" style="color: #ccc; font-size: 12px;"></i> <span style="font-size: 12px; color: #ccc;">{% trans "Платеж защищен шифрованием" %}</span>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const cardNumber = document.getElementById('card-number');
    const cardExpiry = document.getElementById('card-expiry');
    const cardCvv = document.getElementById('card-cvv');

    // Форматирование номера карты (0000 0000 0000 0000)
    cardNumber.addEventListener('input', function(e) {
        // Удаляем все не-цифры
        let value = e.target.value.replace(/\D/g, '');
        // Добавляем пробел после каждых 4 цифр
        if (value.length > 0) {
            value = value.match(/.{1,4}/g).join(' ');
        }
        e.target.value = value;
    });

    // Форматирование срока действия (MM/YY)
    cardExpiry.addEventListener('input', function(e) {
        // Удаляем все не-цифры
        let value = e.target.value.replace(/\D/g, '');
        // Если введено больше 2 цифр, вставляем слэш
        if (value.length > 2) {
            value = value.substring(0, 2) + '/' + value.substring(2, 4);
        }
        e.target.value = value;
    });

    // Форматирование CVV (только 3 цифры)
    cardCvv.addEventListener('input', function(e) {
        // Удаляем все не-цифры
        e.target.value = e.target.value.replace(/\D/g, '');
    });
});
</script>
{% endblock %}
